<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>신문고 상세</title>
  <link rel="stylesheet" th:href="@{/sinmungo/css/sinmungo_detail.css}">
  <!-- 공통 헤더/푸터 -->
  <link rel="stylesheet" href="/header-footer/css/header-footer.css"
        th:href="@{/header-footer/css/header-footer.css}">
  <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
  <script src="/header-footer/js/header-footer.js"
          th:src="@{/header-footer/js/header-footer.js}" defer></script>
</head>

<body class="site">
  <!-- header -->
  <div th:replace="fragments/header :: header"></div>
  <!-- header -->

  <div class="container">
    <h1 class="page-title">공개 상담민원</h1>

    <section class="section">
      <table class="kv-table">
        <colgroup>
          <col style="width:140px">
          <col>
          <col style="width:140px">
          <col>
          <col style="width:140px">
          <col style="width:120px">
        </colgroup>
        <tr>
          <th class="label">목록번호</th>
          <td class="value" th:text="${it.smgId}">293350</td>

          <th class="label">제목</th>
          <td class="value" colspan="3" th:text="${it.title}">파크골프장 복구</td>
        </tr>
        <tr>
          <th class="label">작성자</th>
          <td class="value" th:text="${writerNameMasked != null ? writerNameMasked : '-'}">김○○</td>

          <th class="label">작성일</th>
          <td class="value"
            th:text="${it.createdAt != null ? #temporals.format(it.createdAt, 'yyyy-MM-dd HH:mm:ss') : ''}">
            2025-09-05 15:48:31
          </td>

          <th class="label">조회수</th>
          <td class="value" th:text="${it.viewCount}">11</td>
        </tr>
        <tr>
          <th class="label">공개여부</th>
          <td class="value">내용공개</td>

          <th class="label">결과통지여부</th>
          <td class="value" colspan="3">
            <span th:text="${#strings.equalsIgnoreCase(it.noticeSms, 'Y') 
                ? '게시판답변, 휴대전화 문자메시지(SMS)' 
                : '게시판답변'}">게시판답변</span>
          </td>
        </tr>
      </table>

      <div class="content-box" th:utext="${contentHtml}">본문</div>
    </section>

    <section class="section" th:if="${files != null and !#lists.isEmpty(files)}">
      <div class="attach-card">
        <h2 class="attach-title">첨부파일</h2>
        <ul class="attach-list">
          <li class="attach-item" th:each="f : ${files}">
            <div class="attach-left">
              <span class="attach-badge">FILE</span>
              <a class="attach-name" th:href="${f.url}" th:text="${f.filename}" target="_blank" rel="noopener">
                첨부파일명
              </a>
            </div>
            <div class="attach-size" th:text="${#numbers.formatInteger(f.size, 0) + ' B'}">0 B</div>
          </li>
        </ul>
      </div>
    </section>

    <section class="section">
      <h2 class="section-title">상담답변</h2>
      <table class="answer-table">
        <colgroup>
          <col style="width:140px">
          <col>
          <col style="width:140px">
          <col style="width:220px">
        </colgroup>
        <tr>
          <th>담당부서</th>
          <td><span th:text="${it.adminId != null ? '관리자ID: ' + it.adminId : '-'}">미지정</span></td>

          <th>답변일자</th>
          <td th:text="${it.answerDate != null ? #temporals.format(it.answerDate, 'yyyy-MM-dd HH:mm:ss') : '-'}">&nbsp;
          </td>
        </tr>

        <tr>
          <th>작성자</th>
          <td><span th:text="${it.adminId != null ? '관리자이름' : '-'}">-</span></td>

          <th>접수번호</th>
          <td th:text="${it.smgId}">-</td>
        </tr>

        <tr>
          <th>전화번호</th>
          <td colspan="3" th:text="${it.telNum != null ? '-' : '-'}">&nbsp;</td>
        </tr>
        <tr>
          <td colspan="4" style="height:160px; line-height:1.8; background:#fff;" th:utext="${#strings.isEmpty(adminAnswerHtml) ? 
                     '담당부서에서 처리중입니다.<br><br>처리기한 내 답변 예정입니다.' : adminAnswerHtml}">
            답변
          </td>
        </tr>
      </table>

      <table class="nav-table">
        <tr>
          <th>이전글</th>
          <td>
            <a th:if="${prev != null}" th:href="@{/sinmungo/detail/{id}(id=${prev.smgId},
                   page=${page}, size=${size},
                   keyword=${keyword}, status=${status}, searchType=${searchType})}" th:text="${prev.title}">이전글</a>
            <span th:if="${prev == null}">없음</span>
          </td>
        </tr>
        <tr>
          <th>다음글</th>
          <td>
            <a th:if="${next != null}" th:href="@{/sinmungo/detail/{id}(id=${next.smgId},
                   page=${page}, size=${size},
                   keyword=${keyword}, status=${status}, searchType=${searchType})}" th:text="${next.title}">다음글</a>
            <span th:if="${next == null}">없음</span>
          </td>
        </tr>
      </table>

      <div class="action-bar">
        <a class="btn btn-primary"
          th:href="@{/sinmungo/list(page=${page}, size=${size}, keyword=${keyword}, status=${status}, searchType=${searchType})}">
          목록
        </a>
      </div>
    </section>
  </div>

  <!-- footer -->
  <div th:replace="fragments/footer :: footer"></div>
  <!-- footer -->
</body>

</html>