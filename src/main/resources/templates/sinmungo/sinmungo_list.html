<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>신문고 게시판</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
  <link rel="stylesheet" th:href="@{/sinmungo/css/sinmungo_list.css}">
  <!-- 공통 헤더/푸터 -->
  <link rel="stylesheet" href="/header-footer/css/header-footer.css"
        th:href="@{/header-footer/css/header-footer.css}">
  <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
  <script src="/header-footer/js/header-footer.js"
          th:src="@{/header-footer/js/header-footer.js}" defer></script>
</head>

<body>

  <!-- header -->
  <div th:replace="fragments/header :: header"></div>
  <!-- header -->

  <div class="main-area">
    <div class="main-container">
      <div class="dataset-header-area">
        <h1>신문고</h1>
      </div>

      <form class="search-area" th:action="@{/sinmungo/list}" method="get">
        <div class="content-search-top-area">

          <label class="accessibility-hidden" for="pt_field">검색종류</label>
          <select id="pt_field" name="searchType" style="width:100px;" title="검색종류">
            <option value="title" th:selected="${searchType == 'title'}">제목</option>
            <option value="content" th:selected="${searchType == 'content'}">내용</option>
            <option value="all" th:selected="${searchType == 'all'}">제목+내용</option>
          </select>

          <label class="accessibility-hidden" for="srhKeyword">검색어입력</label>
          <input type="text" name="keyword" id="srhKeyword" class="input-keyword" style="width:200px;" title="검색어"
            th:value="${keyword}">

          <label class="accessibility-hidden" for="pt_deal_state">처리상태</label>
          <select id="pt_deal_state" name="status" style="width:120px;" title="처리상태">
            <option value="" th:selected="${#strings.isEmpty(status)}">답변여부(전체)</option>
            <option value="접수" th:selected="${status} == '접수'">접수</option>
            <option value="처리중" th:selected="${status} == '처리중'">처리중</option>
            <option value="완료" th:selected="${status} == '완료'">완료</option>
          </select>

          <select id="pageSize" name="size" style="width:70px;" title="조회개수">
            <option th:value="10" th:selected="${pageSize} == 10">10개</option>
            <option th:value="20" th:selected="${pageSize} == 20">20개</option>
            <option th:value="50" th:selected="${pageSize} == 50">50개</option>
          </select>

          <input type="hidden" name="page" value="1" />

          <button type="submit" class="search-area-btn search-btn">
            조회 <span class="material-symbols-outlined" style="font-size:16px;vertical-align:-3px;">search</span>
          </button>
        </div>
      </form>

      <div class="content-explain">
        <div class="tablecnt-area">
          <div class="title">신문고 게시판 <span style="font-size:13px; font-weight:400; color:#000;"
              th:text="'(총 ' + ${totalCount} + '건)'">(총0건)</span></div>
        </div>
      </div>

      <table class="table">
        <thead>
          <tr>
            <th>번호</th>
            <th>제목</th>
            <th>작성자</th>
            <th>작성일</th>
            <th>답변여부(처리기한)</th>
            <th>조회</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="it, iterStat : ${items}">
            <td class="td-num" th:text="${totalCount - ((currentPage - 1) * pageSize) - iterStat.index}">
              0
            </td>

            <td class="td-list">
              <a th:href="@{|/sinmungo/detail/${it.smgId}|}" th:text="${it.title}">제목</a>
            </td>

            <td class="td-name"
              th:text="${writerNames != null && it.writerId != null && writerNames[it.writerId] != null ? writerNames[it.writerId] : '-'}">
              -
            </td>

            <td class="td-date" th:text="${it.createdAt != null ? #temporals.format(it.createdAt, 'yyyy-MM-dd') : ''}">
              2025-09-09
            </td>

            <td class="td-answer">
              <span class="state"
                th:classappend="${it.status}=='접수' ? ' recv' : (${it.status}=='처리중' ? ' proc' : ' done')"
                th:text="${it.status}">
                접수
              </span>
            </td>

            <td class="td-state" th:text="${it.viewCount}">0</td>
          </tr>

          <tr th:if="${#lists.isEmpty(items)}">
            <td colspan="6" style="text-align:center;">게시글이 없습니다.</td>
          </tr>
        </tbody>
      </table>

      <!-- 페이징 -->
      <div class="paging" id="navigator">
        <a class="page-btn prev" title="이전 페이지" th:href="@{/sinmungo/list(
              page=${currentPage > 1 ? currentPage - 1 : 1},
              size=${pageSize},
              keyword=${keyword},
              status=${status},
              searchType=${searchType}
            )}">
          <span class="material-symbols-outlined">chevron_left</span>
        </a>

        <a class="page-btn" th:each="p : ${#numbers.sequence(startPage, endPage)}" th:text="${p}" th:href="@{/sinmungo/list(
              page=${p},
              size=${pageSize},
              keyword=${keyword},
              status=${status},
              searchType=${searchType}
            )}" th:classappend="${p == currentPage} ? ' active'">1</a>

        <a class="page-btn next" title="다음 페이지" th:href="@{/sinmungo/list(
              page=${currentPage < totalPages ? currentPage + 1 : totalPages},
              size=${pageSize},
              keyword=${keyword},
              status=${status},
              searchType=${searchType}
            )}">
          <span class="material-symbols-outlined">chevron_right</span>
        </a>
      </div>

    </div>
  </div>

  <!-- footer -->
  <div th:replace="fragments/footer :: footer"></div>
  <!-- footer -->

</body>

</html>