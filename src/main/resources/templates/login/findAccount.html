<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>아이디/비밀번호 찾기</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/findAccount/css/findAccount.css">
</head>
<body>
<div id="container" th:attr="data-active-tab=${activeTab}">

  <div class="tab-menu">
    <div class="tab [[${activeTab}=='id' ? 'active' : '']" data-tab="id">아이디 찾기</div>
    <div class="tab [[${activeTab}=='pw' ? 'active' : '']" data-tab="pw">비밀번호 찾기</div>
  </div>

  

  <!-- 아이디 찾기 -->
  <div id="id" class="form-section [[${activeTab}=='id' ? 'active' : '']]">
    <form th:action="@{/account/find-id}" method="post">
      <input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
      <div class="table_wrap">
        <table class="write_table">
          <tbody>
          <tr>
            <th><label for="name"><span class="redDot">*</span> 이름</label></th>
            <td><input type="text" id="name" name="name" class="input_txt" placeholder="이름 입력" required/></td>
          </tr>
          <tr>
            <th><label for="email"><span class="redDot">*</span> 이메일</label></th>
            <td><input type="email" id="email" name="email" class="input_txt" placeholder="이메일 입력" required/></td>
          </tr>
          </tbody>
        </table>
      </div>
      <div class="btn_set">
        <button type="submit" class="btn">아이디 찾기</button>
      </div>
      <!-- 메시지 -->
      <div class="notice" th:if="${msg}" th:text="${msg}"></div>
      <div class="notice success" th:if="${resultLoginId}">
        찾은 아이디: <strong th:text="${resultLoginId}"></strong>
      </div>
    </form>
  </div>

  <!-- 비밀번호 찾기 (세션 2단계) -->
  <div id="pw" class="form-section [[${activeTab}=='pw' ? 'active' : '']]">
    <form th:action="@{/account/find-pw}" method="post">
      <input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
      <div class="table_wrap">
        <table class="write_table">
          <tbody>
          <tr>
            <th><label for="userid"><span class="redDot">*</span> 아이디</label></th>
            <td><input type="text" id="userid" name="loginId" class="input_txt" placeholder="아이디 입력" required/></td>
          </tr>
          <tr>
            <th><label for="email2"><span class="redDot">*</span> 이메일</label></th>
            <td><input type="email" id="email2" name="email" class="input_txt" placeholder="이메일 입력" required/></td>
          </tr>
          </tbody>
        </table>
      </div>
      <div class="btn_set">
        <button type="submit" class="btn">다음(비밀번호 재설정)</button>
      </div>
      <div class="notice" th:if="${msg}" th:text="${msg}" style="margin-top:12px"></div>
    </form>
  </div>

</div>

<script>
   const tabs = document.querySelectorAll('.tab');
  const sections = document.querySelectorAll('.form-section');

  function setActiveTab(target) {
    if (!target) return;
    tabs.forEach(t => t.classList.toggle('active', t.dataset.tab === target));
    sections.forEach(s => s.classList.toggle('active', s.id === target));
    // 주소 표시도 유지하고 싶으면:
    const url = new URL(window.location.href);
    url.searchParams.set('tab', target);
    history.replaceState(null, '', url.toString());
  }

  // 탭 클릭
  tabs.forEach(tab => {
    tab.addEventListener('click', () => setActiveTab(tab.dataset.tab));
  });

  // 페이지 처음 열릴 때: 서버 값/URL값/기본값 순으로 적용
  window.addEventListener('DOMContentLoaded', () => {
    const serverTab = document.getElementById('container')?.dataset.activeTab; // ex) 'pw'
    const urlTab = new URLSearchParams(location.search).get('tab');
    setActiveTab(serverTab || urlTab || 'id');
  });
</script>
</body>
</html>
